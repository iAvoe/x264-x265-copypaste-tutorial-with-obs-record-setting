# 急用版 x264 x265 压制 + OBS 录屏直播教程
第三个压制教程版本，适用于不想看原理，马上要把参数复制粘贴来用的情况（っ╹◡╹)ﾉ

<font size=4><b>强项:</b></font>

<ol>
    <li>参数质量高，适用范围广</li>
    <li>门槛低，不会操作命令行的话<del>上网一查</del>照着第一页的用法就会</li>
    <li>随时可以下载<a href='https://github.com/iAvoe/x264-x265-qaac-ffprobe-tutorial/blob/master/%E6%95%99%E7%A8%8B.md'>综合版文档</a>更详细的了解原理</li>
    <li>x264急用版附有完整的，带图片的OBS直播录屏软件设置</li>
</ol>

<font size=4><b>差距:</b></font>
<ol>
    <li><del>虽然x265比x264复杂，困难，但在急用版文档中两个编码器使用难度差不多</del></li>
    <li>和其它教程的差距：通过简单计算来得到符合个人情况的参数，例如--merange <ctu减subme减4></li>
    <li>虽然急用版文档里没有提供x264, x265, voukoder, obs的下载链接，但是看综合/精简版文档就有了啊</li>
</ol>

<font size=4><b>下载链接</b>(皆同步更新, QQ群里有很高几率能得到问题答复):</font><br><br>
<a href='https://github.com/iAvoe/x264-x265-copypaste-tutorial-with-obs-record-setting/tree/master/x264x265%E6%80%A5%E7%94%A8%E7%89%88%E5%8E%8B%E5%88%B6%E6%95%99%E7%A8%8BDeploymentReadyTutorial'>Github直链</a>, <a href='https://drive.google.com/open?id=1QFdd18SY2c7dE6d57J-Y6p_80C_QDumg'>谷歌盘</a>, 墙内: <a href='https://pan.baidu.com/s/1sbz8WztGTz3lcLzirHW_2w'>百度云</a>, QQ群存档: <a href='https://jq.qq.com/?_wv=1027&k=5YJFXyf'>691892901</a><br>
附录: <a href='https://www.nazorip.site/archives/44/'>QAAC音频压缩教程-Nazorip站</a>或<a href='github.com/iAvoe/QAAC-Tutorial-Standalone/blob/master/%E6%95%99%E7%A8%8B.md'>Github</a><br>附录: <a href='https://nazorip.site/archives/169/'>ffprobe视频探针教程-Nazorip站</a>或<a href='https://github.com/iAvoe/FFprobe-Tutorial-Standalone/blob/master/教程.md'>Github</a>
## 打赏信息
<font size=3>求个打赏，支持一下吧T_T</font>
<p align="center"><img src="pp_tip_qrcode.png" alt="支持一下"></p>

## 更新信息

**x265 更新 2022.23.5**
<ul>
    <li> √ [x265 | 急用] 全文根据即将到来的x265 v3.6进行了大幅改动<ul>
        <li>引入了mctf，hist-scenecut，hevc-aq参数</li>
        <li>引入了不对称ipratio，pbratio控制（i到b不变，只调节p帧)</li>
        <li>动漫相关预设引入了bframe-bias提高b帧分配率</li>
        <li>引入了红字实验性参数qp-adaptation-range</li>
        <li>所有预设调整min-cu-size，me，rdpenalty，aq-mode，deblock</li>
        <li>冷战参数关闭了大部分跳过</li>
        <li>因兼容性问题移除了opt-qp-pps，opt-ref-list-length-pps</li>
        <li>引入了额外可用参数选项: pme，rc-grain</li>
        <li>将末尾灰字参数作为一个大类重排实现排版整理</li>
    </ul></li>
    <li> √ [x265 | English] Document-wide upgrade was made for the newer x265 v3.6<ul>
        <li>introduced mctf, hist-scenecut, hevc-aq into available presets</li>
        <li>introduced asymmetric ipratio, pbratio mapping（maintain i-b ratio, but altered i-p ratio to reallocate bits for different scenes)</li>
        <li>introduced bframe-bias to promote longer consecutive b frames in anime preset </li>
        <li>introduced "red" EXP parameter qp-adaptation-range</li>
        <li>adjusted min-cu-size，me，rdpenalty，aq-mode，deblock for all presets</li>
        <li>disabled most of fast-skip type of options in Coldwar preset</li>
        <li>removed opt-qp-pps，opt-ref-list-length-pps due to reproducable compatibility problems</li>
        <li>introduced 2 optional parameters: pme，rc-grain</li>
        <li>rewrote grey colored parameters into a block (in the later part of each presets)</li>
    </ul></li>

</ul>

**x265 更新 2022.16**
<ul>
    <li> √ [] 教程工作流升级为Git+Github</li>
    <li> √ [x265 | 急用 | EngVer] 标准参数中增加了constrained-intra和b-intra选项</li>
    <li> √ [x265 | 急用 | EngVer] 缩短了参数示例</li>
    <li> √ [x265 | 急用 | EngVer] 增加了-pix_fmt和-D选项以便用户自定义色深和平面格式</li>
    <li> √ [x265 | 急用 | EngVer] Added -pix_fmt & -D options for custmize pixel depth & color spaces</li>
    <li> √ [x265 | 急用 | EngVer] 标准参数中删除rdpenalty选项</li>
    <li> √ [x265 | 急用 | EngVer] 字幕组参数名称改为动漫·高压·字幕组</li>
    <li> √ [x265 | 急用 | EngVer] Added "High Compression" to Anime·Subtitle param title</li>
    <li> √ [x265 | 急用 | EngVer] 动漫参数增加constrained-intra选项</li>
    <li> √ [x265 | 急用 | EngVer] 修复了b-intra拼写错误，deblock参数值同步错误</li>
    <li> √ [x265 | 急用 | EngVer] Added description for multiple params</li>
    <li> √ [x265 | 急用 | EngVer] 字幕组参数，BDRip冷战参数中rdpenalty值改为3</li>
    <li> √ [x265 | 急用 | EngVer] Changed SubGroup，BDRip Coldwar param's rdpenalty value to 3</li>
    <li> √ [x265 | 急用 | EngVer] BDRip冷战参数中crf值改为15</li>
    <li> √ [x265 | 急用 | EngVer] Changed BDRip Coldwar param's crf option value to 15</li>
    <li> √ [x265 | 急用 | EngVer] 修复了参数说明版块的一些空格缺失，字号不同步等排版错误</li>
    <li> √ [x265 | 急用 | EngVer] Better explanation for multi-node option</li>
    <li> √ [x265 | 急用 | EngVer] 通用·标准参数增加了需要自定义的变量</li>
    <li> √ [x265 | 急用 | EngVer] Extra configurable items in General Purpose·Std. params</li>
</ul>

**x264 x265 更新 2022.13，2022.14.5**
<ul>
    <li> √ [x265 | 急用 & English Version] 在现有预制参数上增加了 - loglevel 16 -hwaccel auto -c:a copy 参数</li>
    <li> √ [x264 | 急用] 在现有预制参数上增加了 - vsync 0 -loglevel 16 -hwaccel auto -c:a copy 参数</li>
    <li> √ [x264 x265 | 急用 & English Version] 增加了 ffmpeg 内置缩放滤镜的使用说明</li>
    <li> √ [x264 x265 | 急用 & English Version] 增加了 ffmpeg 转固定 - 可变 - 删帧率模式的使用说明</li>
</ul>

**x265更新2022.14**
<ul>
    <li> √ [x265 急用] 将原来待填参数值的"?"改为"〇"，解决了字太小可能看不到的问题</li>
    <li> √ [x265 ] English version is now available!</li>
</ul>

**x264 x265更新2022.12X**
<ul>
    <li> √ [x264 急用] 改善了说明页的排版，同时将大量文本链接转位标题+超链接。占地更少且更加美观</li>
    <li> √ [x264 急用] 增加了ffmpeg混流封装命令，ffmpeg替换音频命令，QAAC教程链接</li>
    <li> √ [x264 急用·大更新] 列出了全部预设的x264.exe，ffmpeg libx264-libav私有命令，ffmpeg libx264私有命令，ffmpeg本地libx264命令整体；这下只要拷下来改改输入输出</li>文件名，填写几个参数就能用了</li>
    <li> √ [x265 急用] 提升了BDRip冷战参数的极端程度</li>
    <li> √ [x265 急用] 增加了ffmpeg混流封装命令，ffmpeg替换音频命令，QAAC教程链接</li>
    <li> √ [x265 急用] 改善了说明页的排版，同时将大量文本链接转位标题+超链接。占地更少且更加美观</li>
    <li> √ [x265 急用] 增加了ffmpeg libkvazaar私有命令，虽然很难写但是还是属于凑数性质</li>
    <li> √ [x265 急用·由于排版和编辑难度变态，所以叫特大更新] 列出了全部预设的x265.exe，ffmpeg libx265私有命令整体；这下只要拷下来改改输入输出文件名，填写几个参数就能用。ffmpeg本地命令根本没得用。</li>
    <li> √ [x265 急用 12.3X] 所有x265.exe命令整体改为ffmpeg pipe格式</li>
</ul>

**x265 更新 10.2**
<ul>
    <li>√ 更改了全部提供参数中 rdpenalty 的值</li>
</ul>

**x264 更新 11**
<ul>
    <li> √ 预测显卡降价导致买电脑的人变多，间接让普通用户的平均算力提高，所以提高了参数的计算压力(反正比x265低就行~)</li>
    <li> √ 格式和参数板块全面更新，不同参数的用途区分更明显</li>
    <li> √ 恢复了 HDR 板块</li>
    <li> √ 增加了 sliced-thread 参数的选项</li>
    <li> √ 引入了 fgo 参数</li>
    <li> √ 丢弃了快速参数预设，改为通用 · 简单下的可选项目</li>
    <li> √ 由于长期没能解决选择仅复制参数的问题，遂放弃发布 pdf；鼓励用户可直接从 docx 文本框中选择并拷参数下来</li>
</ul>

**x265更新10**
<ul>
    <li> √ 增加了压制参数：动漫-字幕组</li>
    <li> √ 增加了压制参数：动漫-Ripper冷战</li>
</ul>

**x264更新10, x265更新8**
<ul>
    <li> √ 跟进更新了大部分参数配置，其中变动最大的是x265高压参数</li>
    <li> √ 更新了CMD窗口一步步开始压制的教程</li>
    <li> √ 提高了下载板块的方便程度，增加了用例</li>
</ul>

**x265 更新 6.9**
<ul>
    <li>√ 修复了<ul>
        <li>√ 以下三个<ul>
            <li>√ 疑似 x265 开发者摸黑更新搞出的参数被删问题：<ul>
                <li>√ scenecut-aware-qp的使用限制</li>
                <li>√ max-qp-delta的拆分</li>
                <li>√ hrd参数的依赖</li>
                <li>√ frame-dup参数的依赖</li></ul>
            <li>√ 彻底修复了排版，减少了要考虑的参数数量</li></ul>
        <li>HDR 参数不再处于难受死人，气疯设计师的位置了</li></ul>
    <li>√ 全文排版调整完成，现在一套参数占用一页纸，消除了跨页阅读问题</li>
</ul>

**x264更新8.5，x265 更新 4**
<ul>
    <li> √ 通过难度超高的分栏特技搞定了只复制右边参数，不复制左边小标题的问题</li>
    <li> √ 增加了压制软件工作流程图解</li>
    <li> √ 全文排版调整</li>
</ul>

**x264更新7x**
<ul>
    <li> √ 增加软件截图和一些美观度改良，但由于提升效果巨大所以算作更新</li>
</ul>

**x264更新6**
<ul>
    <li> √ 部分参数增加 non-deterministic（API 格式 = b_deterministic）设定</li>
    <li> √ 修改 merange 设定最大不超过 48</li>
    <li> √ 修改了其它一些参数值</li>
</ul>

**x264更新5**
<ul>
    <li> √ +Twitch 3Afps 1080p60 <8000kbps VBR - 超频 AMD Ryzen 1800x + 3000Mhz CL15 2x4G 直播参数</li>
    <li> √ +Twitch 3Afps 1080p60 <8000kbps VBR - 超频 AMD Ryzen 2700x + 3000Mhz CL15 2x4G 直播参数</li>
    <li> √ +Twitch 3Afps 1080p60 <8000kbps VBR - 默频 AMD Ryzen 3800x + 3000Mhz CL15 2x4G ECC 直播参数</li>
</ul>

**x264重要更新4**
<ul>
    <li> √ 找到了OBS高码率低画质的病根：关了trellis后自动开deadzone 21,11的问题</li>
    <li> √ 增加OBS用的底线crf占用参数：该参数属于基准，如果还卡就按照给出的列表尝试解决除录屏之外的问题</li>
    <li> √ 将CPU占用瞬间提高，导致录屏不流畅。造成的原因有大量NPC，画面效果等提高CPU100%占用的情况纳入考虑</li>
    <li> √ 降低了前半部分一些使用说明字数，缩减了命令行的占用字数，包括将链接缩减成超链接</li>
    <li> √ 降低了OBS截图的面积，精简了一些参数后缀以节省纸张</li>
    <li> √ 将i444到i420的色彩空间设置融入OBS参数中，而不再独立出来</li>
    <li> √ 缩小了页边距，使文档适合家用打印机</li>
    <li> √ 增加频繁黑屏--    <li>CPU太热--    <li>清灰/风扇加速的压制问题解决思路</li>
    <li> √ <del>科普氮化镓CPU如何吊打硅CPU，但为何还没出现在市面上的信息</del> 超纲了</li>
</ul>

**x264更新3**
<ul>
    <li> √ 增加NVENC设置</li>
    <li> √ 修改一些参数设置，特别是改正merange的用法错误</li>
</ul>

**x264 x265更新2**
<ul>
    <li> √ [提升压缩的慢]板块下hme-search的umh应该是star</li>
    <li> √ early-skipm应该是early-skip</li>
    <li> √ x264急用版的OBS设置，增加8核CPU用参数</li>
    <li> √ x264急用版OBS设置，增加提升画质（yuv4:4:4）和对应的参数设置</li>
</ul>

**x264 x265更新1**
<ul>
    <li> 修复了x264文档2019.5版的错误，增加OBS设置和API格式的参数</li>
    <li> x265文档增加了常用，常用·困难和慢但能提升压缩三个参数，并遵守和x264急用版文档一样的格式</li>
</ul>

<b>图1：</b>30~50mbps，正常0.37~2mbps。OBS录制于Folding@Home蛋白质折叠软件，压制难点在其中每个粒子都大范围抖动(还忘了关录音...)；好消息是从截图上（新标签页打开图片，放大看也）看不出明显损失。

<b>配置：</b>57fps 1920x1040 i444；CPU r5 2600 4ghz 占10线程，内存3200mhz CL15

    [crf 18] [4秒关键帧] [预设 medium] [配置 high] [参数 me=hex subme=3 merange=24 ref=2 chroma_me=0 bframes=6 b-adapt=1 aq-mode=2 aq-strength=0.7 trellis=1 threads=10 chroma_qp_offset=2 opencl=1 direct=auto deblock=1:1 psy=0 cabac=1 nr=40]

![效果1.jpg][1]

坏消息是...相同参数和配置给3A游戏录屏，直接卡成PPT...

<b>尝试降低CPU占用，在复杂动态（上图），同配置下CPU占用在23%，低动态下9%：</b>关nr，direct改时间域，降merange，低ref，低aq-mode，占用所有线程

    [crf 19] [4秒关键帧] [预设 medium] [配置 high] [参数 me=hex subme=3 merange=20 ref=2 chroma_me=0 bframes=6 b-adapt=1 aq-mode=1 aq-strength=0.7 trellis=1 threads=12 chroma_qp_offset=2 opencl=1 direct=temporal deblock=1:1 psy=0 cabac=1]

<b>图2：</b>81mbps，正常40mbps。OBS录制于ACE Combat 7，压制难点在找出OBS丢失纹理的原因，发现了因为关了trellis，所以出现了deadzone=21,11参数，导致了一系列画面变脏的问题，重新设定后修复了画面问题，现在用jpg质量95压图也没有这些画面问题了

<b>配置：</b>55fps 1920x1080 i444；CPU r5 2600 4ghz 占10线程，内存3200mhz CL15

    [crf 16] [6秒关键帧] [预设 fast] [配置 high]me=hex me_range=12 subme=3 chroma_me=0 bframes=3 b-adapt=1 qpmax=24 ref=3 aq-mode=0 psy=0 mbtree=0 cabac=0 deadzone-inter=8 deadzone-intra=5 threads=16 deblock=-1:-1 trellis=0 chroma_qp_offset=0 direct=temporal ref=3 opencl=1

![效果2.jpg][2]

  [1]: https://www.nazorip.site/usr/uploads/2020/05/2482235559.png
  [2]: https://www.nazorip.site/usr/uploads/2020/07/2187877554.jpg
